

# Django Управляющие Команды для моделей `Soft`, `Role` и `User`

Этот документ описывает пользовательские Django-команды для управления моделями `Soft`, `Role` и `User`.

---

## Рекомендуемая команда для первого запуска

### `initialize_test_data`
**Описание:** Выполняет полную инициализацию базы данных тестовыми данными. 

Команда выполняет следующие шаги:
1. Удаляет все существующие данные из таблиц **Доступы**, **Программное обеспечение**, **Пользователи** и **Роли**, за исключением суперпользователя `root`.
2. Проверяет наличие суперпользователя `root`. Если его нет, создаёт его с:
   - Логином: `root`
   - Email: `root@root.ru`
   - Паролем: `toor`
3. Добавляет роли `admin` и `user` по умолчанию:
   - `admin`: все разрешения.
   - `user`: без дополнительных разрешений.
4. Предлагает добавить дополнительные роли с помощью команды `add_role`.
5. Генерирует случайных пользователей:
   - Пользователь вводит количество (по умолчанию — 50).
6. Добавляет 100 записей программного обеспечения с помощью команды `add_softs`.
7. Генерирует доступы пользователей к программному обеспечению:
   - Пользователь вводит количество доступов (по умолчанию — 50).

**Использование:**
```bash
python manage.py initialize_test_data
```

**Пример взаимодействия:**
```
Все данные в таблицах Доступы, Программное обеспечение и Пользователи будут удалены!
Вы хотите продолжить? (y/n): y
Пользователь root найден, он не будет удалён.
Удаление всех записей из таблиц...
Все записи успешно удалены.
Добавление ролей...
Роли admin и user успешно добавлены!
Созданы роли:
- admin: все разрешения (add_roles, edit_roles, delete_roles, add_users, edit_users, delete_users).
- user: без дополнительных разрешений.
Добавить ещё одну роль? (y/n): y
Введите название роли: manager
Добавить ещё одну роль? (y/n): y
Введите название роли: viewer
Добавить ещё одну роль? (y/n): n
Роли успешно добавлены.
Введите количество случайных пользователей (по умолчанию 50, нажмите Enter): 
Добавление 50 пользователей...
50 пользователей успешно добавлены.
Добавление 100 записей программного обеспечения...
Программное обеспечение успешно добавлено.
Введите количество доступов к ПО (по умолчанию 50, нажмите Enter): 75
Добавление 75 доступов...
75 доступов успешно добавлены.
Инициализация данных завершена!
```

*Рекомендуется выполнить эту команду при первом запуске приложения, чтобы создать все необходимые тестовые данные.*

---

## Команды для модели `Soft`

### `add_softs`
**Описание:** Добавляет 100 случайных названий ПО с помощью библиотеки `Faker`.

**Использование:**
```bash
python manage.py add_softs
```
*Полезно для заполнения базы тестовыми данными.*

---

### `delete_first_100_softs`
**Описание:** Удаляет первые 100 записей из `Soft`.

**Использование:**
```bash
python manage.py delete_first_100_softs
```
*Удаляет данные.*

---

### `delete_all_softs`
**Описание:** Удаляет все записи из `Soft`.

**Использование:**
```bash
python manage.py delete_all_softs
```
*Используйте для полного сброса данных.*

---

## Команды для модели `Role`

### `create_default_roles`
**Описание:** Создаёт роли `admin` и `user`, если их ещё нет.

**Использование:**
```bash
python manage.py create_default_roles
```
- `admin`: все разрешения.
- `user`: без дополнительных разрешений.

*Полезно для инициализации ролей.*

---

### `add_role`
**Описание:** Создаёт новую роль с пользовательским вводом.

**Использование:**
```bash
python manage.py add_role
```

**Процесс:**
1. Ввод названия роли.
2. Выбор разрешений (y/n).
3. Создание роли с выбранными разрешениями.

*В случае ошибки выкидывает предупреждение: роль с таким названием уже существует.*

---

## Команды для модели `User`

### `add_random_users`
**Описание:** Добавляет случайных пользователей с различными ролями.

**Использование:**
```bash
python manage.py add_random_users [num_users]
```

**Аргументы:**
- `num_users` (необязательный): Количество пользователей для создания. По умолчанию — `50`. 

**Примеры:**
- Создать 50 пользователей (по умолчанию):
  ```bash
  python manage.py add_random_users
  ```
- Создать 100 пользователей:
  ```bash
  python manage.py add_random_users 100
  ```

**Процесс:**
1. Генерируются случайные `username`, `email`, `first_name`, `last_name` с использованием библиотеки `Faker`.
2. Назначаются роли случайным образом из существующих в базе данных.
3. Всем пользователям устанавливается пароль `toor`.

*Внимание: необходимо наличие хотя бы одной роли в базе данных.*

---

## Команды для модели `SoftAccess`

### `add_soft_access`
**Описание:** Генерирует случайные доступы пользователей к программному обеспечению.

**Использование:**
```bash
python manage.py add_soft_access [num_access]
```

**Аргументы:**
- `num_access` (необязательный): Количество доступов для генерации. По умолчанию — `50`.

**Примеры:**
- Сгенерировать 50 доступов (по умолчанию):
  ```bash
  python manage.py add_soft_access
  ```
- Сгенерировать 100 доступов:
  ```bash
  python manage.py add_soft_access 100
  ```

**Процесс:**
1. Генерируются уникальные пары `user`-`soft`.
2. Проверяется уникальность записи в базе данных.
3. Создаются только уникальные доступы.

*Команда учитывает уникальность пар пользователь-ПО и гарантирует, что дублирующиеся записи не создаются.*

---

## Установка и Подготовка

1. Примените миграции:
    ```bash
    python manage.py migrate
    ```
2. Рекомендуется выполнить:
    ```bash
    python manage.py initialize_test_data
    ```
3. Команды готовы к использованию.